<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home Assistant Button Card Editor</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Inter Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Material Design Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@mdi/font@7.4.47/css/materialdesignicons.min.css">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Layout */
        .main-container {
            display: flex;
            height: 100vh;
        }

        .sidebar {
            width: 450px;
            background: rgba(30, 41, 59, 0.95);
            backdrop-filter: blur(20px);
            border-right: 1px solid rgba(148, 163, 184, 0.1);
            overflow-y: auto;
            padding: 1.5rem;
        }

        .preview-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            position: relative;
        }

        /* Custom Scrollbar */
        .sidebar::-webkit-scrollbar {
            width: 8px;
        }

        .sidebar::-webkit-scrollbar-track {
            background: rgba(30, 41, 59, 0.5);
        }

        .sidebar::-webkit-scrollbar-thumb {
            background: rgba(100, 116, 139, 0.5);
            border-radius: 4px;
        }

        .sidebar::-webkit-scrollbar-thumb:hover {
            background: rgba(100, 116, 139, 0.7);
        }

        /* Card Preview */
        .ha-card-preview {
            transition: all 0.3s ease;
            cursor: pointer;
            user-select: none;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-width: 150px;
            position: relative;
        }

        .ha-card-preview:active {
            transform: scale(0.95);
        }

        .card-icon {
            transition: all 0.3s ease;
        }

        .card-icon.state-on {
            filter: drop-shadow(0 0 20px currentColor);
            animation: iconGlow 2s ease-in-out infinite;
        }

        @keyframes iconGlow {
            0%, 100% { opacity: 1; filter: drop-shadow(0 0 10px currentColor); }
            50% { opacity: 0.8; filter: drop-shadow(0 0 20px currentColor); }
        }

        .card-text {
            margin-top: 8px;
            text-align: center;
        }

        /* YAML Output */
        .yaml-output {
            background: rgba(15, 23, 42, 0.95);
            border: 1px solid rgba(148, 163, 184, 0.1);
            border-radius: 12px;
            padding: 1rem;
            margin-top: 2rem;
            max-width: 800px;
            width: 100%;
            position: relative;
        }

        .yaml-code {
            font-family: 'Courier New', monospace;
            font-size: 0.875rem;
            color: #94a3b8;
            white-space: pre-wrap;
            word-break: break-word;
            max-height: 300px;
            overflow-y: auto;
            padding-right: 1rem;
        }

        /* Custom Input Styles */
        .hs-input-dark {
            background-color: rgba(30, 41, 59, 0.5) !important;
            border-color: rgba(148, 163, 184, 0.2) !important;
            color: #e2e8f0 !important;
        }

        .hs-input-dark:focus {
            background-color: rgba(30, 41, 59, 0.7) !important;
            border-color: #60a5fa !important;
        }

        .hs-input-dark::placeholder {
            color: #64748b !important;
        }

        /* Color Picker Button */
        .color-picker-trigger {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            width: 24px;
            height: 24px;
            border-radius: 4px;
            border: 2px solid rgba(148, 163, 184, 0.3);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .color-picker-trigger:hover {
            border-color: #60a5fa;
            transform: translateY(-50%) scale(1.1);
        }

        /* Color Grid */
        .color-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
            margin-bottom: 1rem;
        }

        .color-swatch {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 2px solid transparent;
        }

        .color-swatch:hover {
            transform: scale(1.1);
            border-color: #fff;
        }

        /* State Toggle */
        .state-toggle-group {
            display: flex;
            background: rgba(30, 41, 59, 0.5);
            border-radius: 8px;
            padding: 4px;
            margin-bottom: 1rem;
        }

        .state-toggle-btn {
            flex: 1;
            padding: 0.5rem 1rem;
            border: none;
            background: transparent;
            color: #94a3b8;
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.2s ease;
            font-weight: 500;
        }

        .state-toggle-btn.active {
            background: #3b82f6;
            color: #fff;
        }

        /* Accordion Custom Styles */
        .hs-accordion-group {
            background: transparent !important;
        }

        .hs-accordion {
            background: rgba(30, 41, 59, 0.3);
            border: 1px solid rgba(148, 163, 184, 0.1);
            border-radius: 12px;
            margin-bottom: 1rem;
            overflow: hidden;
        }

        .hs-accordion-toggle {
            background: rgba(30, 41, 59, 0.5);
            color: #e2e8f0;
            padding: 1rem;
            font-weight: 600;
            transition: all 0.2s ease;
        }

        .hs-accordion-toggle:hover {
            background: rgba(30, 41, 59, 0.7);
        }

        .hs-accordion-content {
            background: rgba(15, 23, 42, 0.3);
            padding: 1rem;
        }

        /* Labels */
        label {
            color: #94a3b8;
            font-size: 0.875rem;
            font-weight: 500;
        }

        /* Toggle Switch Custom */
        .hs-toggle {
            background-color: rgba(100, 116, 139, 0.3) !important;
        }

        .hs-toggle:checked {
            background-color: #3b82f6 !important;
        }
    </style>
</head>
<body>
    <div class="main-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <h2 class="text-2xl font-bold text-white mb-6">Button Card Editor</h2>

            <!-- State Simulation -->
            <div class="mb-6">
                <label class="block mb-2">State Simulation</label>
                <div class="state-toggle-group">
                    <button class="state-toggle-btn active" data-state="off">Off</button>
                    <button class="state-toggle-btn" data-state="on">On</button>
                </div>
            </div>

            <!-- Accordion Panels -->
            <div class="hs-accordion-group">
                <!-- Display Options Panel -->
                <div class="hs-accordion active" id="display-accordion">
                    <button class="hs-accordion-toggle" aria-expanded="true" aria-controls="display-collapse">
                        <span class="flex items-center gap-2">
                            <i class="mdi mdi-eye"></i>
                            Display Options
                        </span>
                        <svg class="hs-accordion-active:hidden block size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="m6 9 6 6 6-6"></path>
                        </svg>
                        <svg class="hs-accordion-active:block hidden size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="m18 15-6-6-6 6"></path>
                        </svg>
                    </button>
                    <div id="display-collapse" class="hs-accordion-content w-full overflow-hidden transition-[height] duration-300">
                        <div class="space-y-3">
                            <div class="flex items-center justify-between">
                                <label for="show-name">Show Name</label>
                                <input type="checkbox" id="show-name" class="hs-toggle" checked>
                            </div>
                            <div class="flex items-center justify-between">
                                <label for="show-icon">Show Icon</label>
                                <input type="checkbox" id="show-icon" class="hs-toggle" checked>
                            </div>
                            <div class="flex items-center justify-between">
                                <label for="show-state">Show State</label>
                                <input type="checkbox" id="show-state" class="hs-toggle">
                            </div>
                            <div class="flex items-center justify-between">
                                <label for="show-label">Show Label</label>
                                <input type="checkbox" id="show-label" class="hs-toggle" checked>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Content Settings Panel -->
                <div class="hs-accordion active" id="content-accordion">
                    <button class="hs-accordion-toggle" aria-expanded="true" aria-controls="content-collapse">
                        <span class="flex items-center gap-2">
                            <i class="mdi mdi-text"></i>
                            Content Settings
                        </span>
                        <svg class="hs-accordion-active:hidden block size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="m6 9 6 6 6-6"></path>
                        </svg>
                        <svg class="hs-accordion-active:block hidden size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="m18 15-6-6-6 6"></path>
                        </svg>
                    </button>
                    <div id="content-collapse" class="hs-accordion-content w-full overflow-hidden transition-[height] duration-300">
                        <div class="space-y-4">
                            <div class="relative">
                                <input type="text" id="entity" class="peer py-3 px-4 block w-full hs-input-dark border rounded-lg text-sm focus:border-blue-500 focus:ring-blue-500" placeholder=" " value="sensor.helper_count_lights_on_interior">
                                <label class="absolute top-0 start-0 p-4 h-full text-sm truncate pointer-events-none transition ease-in-out duration-100 border border-transparent peer-disabled:opacity-50 peer-disabled:pointer-events-none peer-focus:text-xs peer-focus:-translate-y-1.5 peer-focus:text-blue-500 peer-[:not(:placeholder-shown)]:text-xs peer-[:not(:placeholder-shown)]:-translate-y-1.5 peer-[:not(:placeholder-shown)]:text-gray-500">Entity</label>
                            </div>

                            <div class="relative">
                                <input type="text" id="name" class="peer py-3 px-4 block w-full hs-input-dark border rounded-lg text-sm focus:border-blue-500 focus:ring-blue-500" placeholder=" " value="Lights On">
                                <label class="absolute top-0 start-0 p-4 h-full text-sm truncate pointer-events-none transition ease-in-out duration-100 border border-transparent peer-disabled:opacity-50 peer-disabled:pointer-events-none peer-focus:text-xs peer-focus:-translate-y-1.5 peer-focus:text-blue-500 peer-[:not(:placeholder-shown)]:text-xs peer-[:not(:placeholder-shown)]:-translate-y-1.5 peer-[:not(:placeholder-shown)]:text-gray-500">Name</label>
                            </div>

                            <div class="relative">
                                <input type="text" id="label" class="peer py-3 px-4 block w-full hs-input-dark border rounded-lg text-sm focus:border-blue-500 focus:ring-blue-500" placeholder=" " value="Inside">
                                <label class="absolute top-0 start-0 p-4 h-full text-sm truncate pointer-events-none transition ease-in-out duration-100 border border-transparent peer-disabled:opacity-50 peer-disabled:pointer-events-none peer-focus:text-xs peer-focus:-translate-y-1.5 peer-focus:text-blue-500 peer-[:not(:placeholder-shown)]:text-xs peer-[:not(:placeholder-shown)]:-translate-y-1.5 peer-[:not(:placeholder-shown)]:text-gray-500">Label</label>
                            </div>

                            <div>
                                <label for="icon-select" class="block mb-2">Icon</label>
                                <div class="flex items-center gap-2">
                                    <select id="icon-select" class="py-3 px-4 block flex-1 hs-input-dark border rounded-lg text-sm focus:border-blue-500 focus:ring-blue-500">
                                        <option value="mdi:lightbulb-on" selected>mdi:lightbulb-on</option>
                                        <option value="mdi:lightbulb">mdi:lightbulb</option>
                                        <option value="mdi:lightbulb-outline">mdi:lightbulb-outline</option>
                                        <option value="mdi:lamp">mdi:lamp</option>
                                        <option value="mdi:ceiling-light">mdi:ceiling-light</option>
                                        <option value="mdi:floor-lamp">mdi:floor-lamp</option>
                                        <option value="mdi:led-strip">mdi:led-strip</option>
                                        <option value="mdi:home">mdi:home</option>
                                        <option value="mdi:sofa">mdi:sofa</option>
                                        <option value="mdi:bed">mdi:bed</option>
                                        <option value="mdi:door">mdi:door</option>
                                        <option value="mdi:window-open">mdi:window-open</option>
                                        <option value="mdi:fan">mdi:fan</option>
                                        <option value="mdi:air-conditioner">mdi:air-conditioner</option>
                                        <option value="mdi:thermometer">mdi:thermometer</option>
                                        <option value="mdi:water">mdi:water</option>
                                        <option value="mdi:motion-sensor">mdi:motion-sensor</option>
                                        <option value="mdi:cctv">mdi:cctv</option>
                                        <option value="mdi:lock">mdi:lock</option>
                                        <option value="mdi:shield-home">mdi:shield-home</option>
                                        <option value="mdi:television">mdi:television</option>
                                        <option value="mdi:speaker">mdi:speaker</option>
                                        <option value="mdi:power-plug">mdi:power-plug</option>
                                        <option value="mdi:wifi">mdi:wifi</option>
                                    </select>
                                    <i id="icon-preview" class="mdi mdi-lightbulb-on text-2xl text-gray-400"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Visual Styling Panel -->
                <div class="hs-accordion active" id="styling-accordion">
                    <button class="hs-accordion-toggle" aria-expanded="true" aria-controls="styling-collapse">
                        <span class="flex items-center gap-2">
                            <i class="mdi mdi-palette"></i>
                            Visual Styling
                        </span>
                        <svg class="hs-accordion-active:hidden block size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="m6 9 6 6 6-6"></path>
                        </svg>
                        <svg class="hs-accordion-active:block hidden size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="m18 15-6-6-6 6"></path>
                        </svg>
                    </button>
                    <div id="styling-collapse" class="hs-accordion-content w-full overflow-hidden transition-[height] duration-300">
                        <div class="space-y-4">
                            <div class="relative">
                                <input type="text" id="bg-color" class="peer py-3 px-4 pr-12 block w-full hs-input-dark border rounded-lg text-sm focus:border-blue-500 focus:ring-blue-500" placeholder=" " value="rgba(30,41,59,0.5)">
                                <label class="absolute top-0 start-0 p-4 h-full text-sm truncate pointer-events-none transition ease-in-out duration-100 border border-transparent peer-disabled:opacity-50 peer-disabled:pointer-events-none peer-focus:text-xs peer-focus:-translate-y-1.5 peer-focus:text-blue-500 peer-[:not(:placeholder-shown)]:text-xs peer-[:not(:placeholder-shown)]:-translate-y-1.5 peer-[:not(:placeholder-shown)]:text-gray-500">Background Color</label>
                                <div class="color-picker-trigger" data-target="bg-color" style="background: rgba(30,41,59,0.5)"></div>
                            </div>

                            <div class="relative">
                                <input type="text" id="icon-color-off" class="peer py-3 px-4 pr-12 block w-full hs-input-dark border rounded-lg text-sm focus:border-blue-500 focus:ring-blue-500" placeholder=" " value="#64748b">
                                <label class="absolute top-0 start-0 p-4 h-full text-sm truncate pointer-events-none transition ease-in-out duration-100 border border-transparent peer-disabled:opacity-50 peer-disabled:pointer-events-none peer-focus:text-xs peer-focus:-translate-y-1.5 peer-focus:text-blue-500 peer-[:not(:placeholder-shown)]:text-xs peer-[:not(:placeholder-shown)]:-translate-y-1.5 peer-[:not(:placeholder-shown)]:text-gray-500">Icon Color (Off)</label>
                                <div class="color-picker-trigger" data-target="icon-color-off" style="background: #64748b"></div>
                            </div>

                            <div class="relative">
                                <input type="text" id="icon-color-on" class="peer py-3 px-4 pr-12 block w-full hs-input-dark border rounded-lg text-sm focus:border-blue-500 focus:ring-blue-500" placeholder=" " value="#37C7BA">
                                <label class="absolute top-0 start-0 p-4 h-full text-sm truncate pointer-events-none transition ease-in-out duration-100 border border-transparent peer-disabled:opacity-50 peer-disabled:pointer-events-none peer-focus:text-xs peer-focus:-translate-y-1.5 peer-focus:text-blue-500 peer-[:not(:placeholder-shown)]:text-xs peer-[:not(:placeholder-shown)]:-translate-y-1.5 peer-[:not(:placeholder-shown)]:text-gray-500">Icon Color (On)</label>
                                <div class="color-picker-trigger" data-target="icon-color-on" style="background: #37C7BA"></div>
                            </div>

                            <div class="grid grid-cols-2 gap-4">
                                <div class="relative">
                                    <input type="text" id="border-radius" class="peer py-3 px-4 block w-full hs-input-dark border rounded-lg text-sm focus:border-blue-500 focus:ring-blue-500" placeholder=" " value="18px">
                                    <label class="absolute top-0 start-0 p-4 h-full text-sm truncate pointer-events-none transition ease-in-out duration-100 border border-transparent peer-disabled:opacity-50 peer-disabled:pointer-events-none peer-focus:text-xs peer-focus:-translate-y-1.5 peer-focus:text-blue-500 peer-[:not(:placeholder-shown)]:text-xs peer-[:not(:placeholder-shown)]:-translate-y-1.5 peer-[:not(:placeholder-shown)]:text-gray-500">Border Radius</label>
                                </div>

                                <div class="relative">
                                    <input type="text" id="card-height" class="peer py-3 px-4 block w-full hs-input-dark border rounded-lg text-sm focus:border-blue-500 focus:ring-blue-500" placeholder=" " value="120px">
                                    <label class="absolute top-0 start-0 p-4 h-full text-sm truncate pointer-events-none transition ease-in-out duration-100 border border-transparent peer-disabled:opacity-50 peer-disabled:pointer-events-none peer-focus:text-xs peer-focus:-translate-y-1.5 peer-focus:text-blue-500 peer-[:not(:placeholder-shown)]:text-xs peer-[:not(:placeholder-shown)]:-translate-y-1.5 peer-[:not(:placeholder-shown)]:text-gray-500">Height</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Actions Panel -->
                <div class="hs-accordion" id="actions-accordion">
                    <button class="hs-accordion-toggle" aria-expanded="false" aria-controls="actions-collapse">
                        <span class="flex items-center gap-2">
                            <i class="mdi mdi-gesture-tap"></i>
                            Actions
                        </span>
                        <svg class="hs-accordion-active:hidden block size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="m6 9 6 6 6-6"></path>
                        </svg>
                        <svg class="hs-accordion-active:block hidden size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="m18 15-6-6-6 6"></path>
                        </svg>
                    </button>
                    <div id="actions-collapse" class="hs-accordion-content hidden w-full overflow-hidden transition-[height] duration-300">
                        <div class="space-y-4">
                            <div>
                                <label for="tap-action" class="block mb-2">Tap Action</label>
                                <select id="tap-action" class="py-3 px-4 block w-full hs-input-dark border rounded-lg text-sm focus:border-blue-500 focus:ring-blue-500">
                                    <option value="toggle" selected>Toggle</option>
                                    <option value="more-info">More Info</option>
                                    <option value="navigate">Navigate</option>
                                    <option value="call-service">Call Service</option>
                                    <option value="none">None</option>
                                </select>
                            </div>

                            <div>
                                <label for="hold-action" class="block mb-2">Hold Action</label>
                                <select id="hold-action" class="py-3 px-4 block w-full hs-input-dark border rounded-lg text-sm focus:border-blue-500 focus:ring-blue-500">
                                    <option value="more-info" selected>More Info</option>
                                    <option value="toggle">Toggle</option>
                                    <option value="navigate">Navigate</option>
                                    <option value="call-service">Call Service</option>
                                    <option value="none">None</option>
                                </select>
                            </div>

                            <div>
                                <label for="double-tap-action" class="block mb-2">Double Tap Action</label>
                                <select id="double-tap-action" class="py-3 px-4 block w-full hs-input-dark border rounded-lg text-sm focus:border-blue-500 focus:ring-blue-500">
                                    <option value="toggle" selected>Toggle</option>
                                    <option value="more-info">More Info</option>
                                    <option value="navigate">Navigate</option>
                                    <option value="call-service">Call Service</option>
                                    <option value="none">None</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Preview Area -->
        <div class="preview-area">
            <h3 class="text-xl font-semibold text-white mb-4">Card Preview</h3>

            <!-- Card Preview -->
            <div id="card-preview" class="ha-card-preview" style="background: rgba(30,41,59,0.5); border-radius: 18px; height: 120px; padding: 15px 30px; box-shadow: 0 4px 12px rgba(0,0,0,0.2);">
                <i id="preview-icon" class="card-icon mdi mdi-lightbulb-on" style="font-size: 4rem; color: #64748b;"></i>
                <div class="card-text">
                    <div id="preview-name" style="color: #64748b; font-size: 1.1rem; font-weight: 600;">Lights On</div>
                    <div id="preview-state" style="color: #64748b; font-size: 0.9rem; display: none;">off</div>
                    <div id="preview-label" style="color: #64748b; font-size: 0.8rem; margin-top: 2px;">Inside</div>
                </div>
            </div>

            <!-- YAML Output -->
            <div class="yaml-output">
                <div class="flex justify-between items-center mb-3">
                    <h4 class="text-lg font-semibold text-white">YAML Configuration</h4>
                    <button id="copy-yaml" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-all duration-200 flex items-center gap-2">
                        <i class="mdi mdi-content-copy"></i>
                        Copy
                    </button>
                </div>
                <pre id="yaml-code" class="yaml-code"></pre>
            </div>
        </div>
    </div>

    <!-- Color Picker Modal -->
    <div id="color-picker-modal" class="hs-overlay hidden size-full fixed top-0 start-0 z-[80] overflow-x-hidden overflow-y-auto pointer-events-none" role="dialog" tabindex="-1">
        <div class="hs-overlay-open:mt-7 hs-overlay-open:opacity-100 hs-overlay-open:duration-500 mt-0 opacity-0 ease-out transition-all sm:max-w-lg sm:w-full m-3 sm:mx-auto">
            <div class="bg-gray-800 border border-gray-700 shadow-sm rounded-xl pointer-events-auto">
                <div class="flex justify-between items-center py-3 px-4 border-b border-gray-700">
                    <h3 class="font-bold text-white">Choose Color</h3>
                    <button type="button" class="size-8 inline-flex justify-center items-center gap-x-2 rounded-full border border-transparent bg-gray-700 text-gray-400 hover:bg-gray-600 hover:text-white transition-all" onclick="closeColorPicker()">
                        <span class="sr-only">Close</span>
                        <svg class="shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M18 6 6 18"></path>
                            <path d="m6 6 12 12"></path>
                        </svg>
                    </button>
                </div>
                <div class="p-4 overflow-y-auto max-h-96">
                    <input type="hidden" id="color-target-input">

                    <!-- Preline Colors -->
                    <div class="mb-4">
                        <h5 class="text-sm font-semibold text-gray-400 mb-2">Blue</h5>
                        <div class="color-grid">
                            <div class="color-swatch" style="background: #dbeafe;" onclick="selectColor('#dbeafe')"></div>
                            <div class="color-swatch" style="background: #bfdbfe;" onclick="selectColor('#bfdbfe')"></div>
                            <div class="color-swatch" style="background: #93c5fd;" onclick="selectColor('#93c5fd')"></div>
                            <div class="color-swatch" style="background: #60a5fa;" onclick="selectColor('#60a5fa')"></div>
                            <div class="color-swatch" style="background: #3b82f6;" onclick="selectColor('#3b82f6')"></div>
                        </div>
                    </div>

                    <div class="mb-4">
                        <h5 class="text-sm font-semibold text-gray-400 mb-2">Cyan</h5>
                        <div class="color-grid">
                            <div class="color-swatch" style="background: #cffafe;" onclick="selectColor('#cffafe')"></div>
                            <div class="color-swatch" style="background: #a5f3fc;" onclick="selectColor('#a5f3fc')"></div>
                            <div class="color-swatch" style="background: #67e8f9;" onclick="selectColor('#67e8f9')"></div>
                            <div class="color-swatch" style="background: #22d3ee;" onclick="selectColor('#22d3ee')"></div>
                            <div class="color-swatch" style="background: #06b6d4;" onclick="selectColor('#06b6d4')"></div>
                        </div>
                    </div>

                    <div class="mb-4">
                        <h5 class="text-sm font-semibold text-gray-400 mb-2">Green</h5>
                        <div class="color-grid">
                            <div class="color-swatch" style="background: #dcfce7;" onclick="selectColor('#dcfce7')"></div>
                            <div class="color-swatch" style="background: #bbf7d0;" onclick="selectColor('#bbf7d0')"></div>
                            <div class="color-swatch" style="background: #86efac;" onclick="selectColor('#86efac')"></div>
                            <div class="color-swatch" style="background: #4ade80;" onclick="selectColor('#4ade80')"></div>
                            <div class="color-swatch" style="background: #22c55e;" onclick="selectColor('#22c55e')"></div>
                        </div>
                    </div>

                    <div class="mb-4">
                        <h5 class="text-sm font-semibold text-gray-400 mb-2">Custom Colors</h5>
                        <div class="color-grid">
                            <div class="color-swatch" style="background: #37C7BA;" onclick="selectColor('#37C7BA')"></div>
                            <div class="color-swatch" style="background: #ff6b6b;" onclick="selectColor('#ff6b6b')"></div>
                            <div class="color-swatch" style="background: #ffd93d;" onclick="selectColor('#ffd93d')"></div>
                            <div class="color-swatch" style="background: #a78bfa;" onclick="selectColor('#a78bfa')"></div>
                            <div class="color-swatch" style="background: #f472b6;" onclick="selectColor('#f472b6')"></div>
                        </div>
                    </div>

                    <div class="mb-4">
                        <h5 class="text-sm font-semibold text-gray-400 mb-2">Gray</h5>
                        <div class="color-grid">
                            <div class="color-swatch" style="background: #f3f4f6;" onclick="selectColor('#f3f4f6')"></div>
                            <div class="color-swatch" style="background: #d1d5db;" onclick="selectColor('#d1d5db')"></div>
                            <div class="color-swatch" style="background: #9ca3af;" onclick="selectColor('#9ca3af')"></div>
                            <div class="color-swatch" style="background: #64748b;" onclick="selectColor('#64748b')"></div>
                            <div class="color-swatch" style="background: #475569;" onclick="selectColor('#475569')"></div>
                        </div>
                    </div>

                    <div>
                        <h5 class="text-sm font-semibold text-gray-400 mb-2">Special</h5>
                        <div class="flex gap-2">
                            <button class="px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-all" onclick="selectColor('transparent')">Transparent</button>
                            <button class="px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-all" onclick="selectColor('rgba(30,41,59,0.5)')">Glass Dark</button>
                            <button class="px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-all" onclick="selectColor('rgba(255,255,255,0.1)')">Glass Light</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="color-picker-backdrop" class="hs-overlay-backdrop hidden transition duration fixed inset-0 bg-gray-900 bg-opacity-80 z-[79]"></div>

    <!-- Preline UI -->
    <script src="https://cdn.jsdelivr.net/npm/preline@2.5.0/dist/preline.min.js"></script>

    <script>
        // Initialize variables
        let currentState = 'off';
        let selectedIcon = 'mdi:lightbulb-on';

        // State toggle functionality
        document.querySelectorAll('.state-toggle-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.state-toggle-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                currentState = this.dataset.state;
                updatePreview();
            });
        });

        // Icon selection
        document.getElementById('icon-select').addEventListener('change', function() {
            selectedIcon = this.value;
            const iconClass = selectedIcon.replace(':', '-');
            document.getElementById('icon-preview').className = `mdi ${iconClass} text-2xl text-gray-400`;
            updatePreview();
        });

        // Input listeners
        const inputs = ['entity', 'name', 'label', 'bg-color', 'icon-color-off', 'icon-color-on', 'border-radius', 'card-height'];
        inputs.forEach(id => {
            document.getElementById(id).addEventListener('input', updatePreview);
        });

        // Checkbox listeners
        const checkboxes = ['show-name', 'show-icon', 'show-state', 'show-label'];
        checkboxes.forEach(id => {
            document.getElementById(id).addEventListener('change', updatePreview);
        });

        // Action listeners
        ['tap-action', 'hold-action', 'double-tap-action'].forEach(id => {
            document.getElementById(id).addEventListener('change', generateYAML);
        });

        // Color picker functionality
        document.querySelectorAll('.color-picker-trigger').forEach(trigger => {
            trigger.addEventListener('click', function() {
                const targetId = this.dataset.target;
                openColorPicker(targetId);
            });
        });

        function openColorPicker(targetInputId) {
            document.getElementById('color-target-input').value = targetInputId;
            document.getElementById('color-picker-modal').classList.remove('hidden');
            document.getElementById('color-picker-modal').classList.add('pointer-events-auto');
            document.getElementById('color-picker-backdrop').classList.remove('hidden');
        }

        function closeColorPicker() {
            document.getElementById('color-picker-modal').classList.add('hidden');
            document.getElementById('color-picker-modal').classList.remove('pointer-events-auto');
            document.getElementById('color-picker-backdrop').classList.add('hidden');
        }

        function selectColor(color) {
            const targetInputId = document.getElementById('color-target-input').value;
            const targetInput = document.getElementById(targetInputId);
            targetInput.value = color;

            // Update color picker trigger preview
            const trigger = document.querySelector(`.color-picker-trigger[data-target="${targetInputId}"]`);
            if (trigger) {
                trigger.style.background = color;
            }

            closeColorPicker();
            updatePreview();
        }

        // Update preview function
        function updatePreview() {
            const card = document.getElementById('card-preview');
            const icon = document.getElementById('preview-icon');
            const name = document.getElementById('preview-name');
            const state = document.getElementById('preview-state');
            const label = document.getElementById('preview-label');

            // Update card styles
            card.style.background = document.getElementById('bg-color').value;
            card.style.borderRadius = document.getElementById('border-radius').value;
            card.style.height = document.getElementById('card-height').value;

            // Update icon
            const iconClass = selectedIcon.replace(':', '-');
            icon.className = `card-icon mdi ${iconClass}`;
            icon.style.fontSize = '4rem';

            // Update icon color based on state
            if (currentState === 'on') {
                icon.style.color = document.getElementById('icon-color-on').value;
                icon.classList.add('state-on');
                card.style.boxShadow = `0 8px 24px ${hexToRgba(document.getElementById('icon-color-on').value, 0.3)}`;
                name.style.color = document.getElementById('icon-color-on').value;
                state.style.color = document.getElementById('icon-color-on').value;
                label.style.color = document.getElementById('icon-color-on').value;
                state.textContent = 'on';
            } else {
                icon.style.color = document.getElementById('icon-color-off').value;
                icon.classList.remove('state-on');
                card.style.boxShadow = '0 4px 12px rgba(0,0,0,0.2)';
                name.style.color = document.getElementById('icon-color-off').value;
                state.style.color = document.getElementById('icon-color-off').value;
                label.style.color = document.getElementById('icon-color-off').value;
                state.textContent = 'off';
            }

            // Update text content
            name.textContent = document.getElementById('name').value;
            label.textContent = document.getElementById('label').value;

            // Show/hide elements
            icon.style.display = document.getElementById('show-icon').checked ? 'block' : 'none';
            name.style.display = document.getElementById('show-name').checked ? 'block' : 'none';
            state.style.display = document.getElementById('show-state').checked ? 'block' : 'none';
            label.style.display = document.getElementById('show-label').checked ? 'block' : 'none';

            generateYAML();
        }

        // Generate YAML function
        function generateYAML() {
            const entity = document.getElementById('entity').value;
            const name = document.getElementById('name').value;
            const label = document.getElementById('label').value;
            const bgColor = document.getElementById('bg-color').value;
            const iconColorOff = document.getElementById('icon-color-off').value;
            const iconColorOn = document.getElementById('icon-color-on').value;
            const borderRadius = document.getElementById('border-radius').value;
            const cardHeight = document.getElementById('card-height').value;

            const showName = document.getElementById('show-name').checked;
            const showIcon = document.getElementById('show-icon').checked;
            const showState = document.getElementById('show-state').checked;
            const showLabel = document.getElementById('show-label').checked;

            const tapAction = document.getElementById('tap-action').value;
            const holdAction = document.getElementById('hold-action').value;
            const doubleTapAction = document.getElementById('double-tap-action').value;

            let yaml = `type: custom:button-card
entity: ${entity}
icon: ${selectedIcon}
name: ${name}
label: ${label}
show_name: ${showName}
show_icon: ${showIcon}
show_state: ${showState}
show_label: ${showLabel}
styles:
  card:
    - background-color: ${bgColor}
    - border-radius: ${borderRadius}
    - height: ${cardHeight}
    - padding: 15px 0
    - box-shadow: 0 4px 12px rgba(0,0,0,0.2)
  icon:
    - color: "${iconColorOff}"
    - width: clamp(3.5rem, 4vw, 4.5rem)
    - height: clamp(3.5rem, 4vw, 4.5rem)
  name:
    - color: "${iconColorOff}"
    - font-size: clamp(.8rem, 1vw, 1.25rem)
    - font-weight: 600
  label:
    - color: "${iconColorOff}"
    - font-size: clamp(.6rem, .7vw, .9rem)
state:
  - value: "on"
    styles:
      card:
        - box-shadow: 0 8px 24px ${hexToRgba(iconColorOn, 0.3)}
      icon:
        - color: "${iconColorOn}"
        - animation: iconGlow 2s ease-in-out infinite
      name:
        - color: "${iconColorOn}"
      label:
        - color: "${iconColorOn}"
tap_action:
  action: ${tapAction}
hold_action:
  action: ${holdAction}
double_tap_action:
  action: ${doubleTapAction}`;

            document.getElementById('yaml-code').textContent = yaml;
        }

        // Copy YAML functionality
        document.getElementById('copy-yaml').addEventListener('click', function() {
            const yamlText = document.getElementById('yaml-code').textContent;
            navigator.clipboard.writeText(yamlText).then(() => {
                const btn = this;
                const originalHTML = btn.innerHTML;
                btn.innerHTML = '<i class="mdi mdi-check"></i> Copied!';
                btn.classList.remove('bg-blue-600');
                btn.classList.add('bg-green-600');

                setTimeout(() => {
                    btn.innerHTML = originalHTML;
                    btn.classList.remove('bg-green-600');
                    btn.classList.add('bg-blue-600');
                }, 2000);
            });
        });

        // Helper function to convert hex to rgba
        function hexToRgba(hex, alpha) {
            if (hex.startsWith('rgba')) return hex;
            if (hex === 'transparent') return 'rgba(0,0,0,0)';

            const r = parseInt(hex.slice(1, 3), 16);
            const g = parseInt(hex.slice(3, 5), 16);
            const b = parseInt(hex.slice(5, 7), 16);

            return `rgba(${r}, ${g}, ${b}, ${alpha})`;
        }

        // Backdrop click to close modal
        document.getElementById('color-picker-backdrop').addEventListener('click', closeColorPicker);

        // Initialize on load
        updatePreview();
    </script>
</body>
</html>